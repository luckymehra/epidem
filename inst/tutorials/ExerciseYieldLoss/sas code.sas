DATA A;
INPUT WP SP $ BLK TRT FUNG DS YIELD;
CARDS;
101	A	1	1	0	43	205
101	B	1	1	1	1	399
102	A	1	2	1	2	426
102	B	1	2	0	92	102
103	A	1	3	1	2	385
103	B	1	3	0	7	355
201	A	2	2	1	4	412
201	B	2	2	0	75	224
202	A	2	3	1	3	425
202	B	2	3	0	10	352
203	A	2	1	0	27	330
203	B	2	1	1	2	375
301	A	3	1	1	2	420
301	B	3	1	0	47	303
302	A	3	3	0	12	342
302	B	3	3	1	1	395
303	A	3	2	0	63	222
303	B	3	2	1	3	393
401	A	4	3	0	12	326
401	B	4	3	1	1	400
402	A	4	1	0	32	289
402	B	4	1	1	1	418
403	A	4	2	1	2	371
403	B	4	2	0	53	175
;
PROC MIXED COVTEST METHOD=TYPE3;
CLASS BLK TRT FUNG;
MODEL DS=TRT|FUNG/RESIDUAL;
RANDOM BLK BLK*TRT;
LSMEANS TRT|FUNG/DIFF;
run;

PROC MIXED COVTEST METHOD=TYPE3;
CLASS BLK TRT FUNG;
MODEL YIELD=TRT|FUNG/RESIDUAL;
RANDOM BLK BLK*TRT;
LSMEANS TRT|FUNG/DIFF;

PROC REG;
MODEL YIELD=DS;

DATA B;
SET A;
RY1=YIELD/399.23843;

PROC REG;
MODEL RY1=DS;


PROC SORT DATA=A; BY BLK TRT FUNG;
PROC TRANSPOSE DATA=A OUT=T1A; BY BLK TRT;
VAR YIELD;
run;

DATA T2A;
SET T1A;
RY2=COL1/COL2;
DROP _NAME_ COL1 COL2;
run;

PROC TRANSPOSE DATA=A OUT=T1B; BY BLK TRT;
VAR DS;
run;

DATA T2B;
SET T1B;
CDS=COL1;
DROP _NAME_ COL1 COL2;
run;

DATA T3;
MERGE T2A T2B;
BY BLK TRT; 

PROC PRINT;
run;

PROC MIXED COVTEST;
CLASS BLK TRT;
MODEL RY2=TRT/RESIDUAL;
RANDOM BLK;
LSMEANS TRT/DIFF;

PROC REG;
MODEL RY2=CDS;


RUN;

